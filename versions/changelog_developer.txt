# RPG Mod — Журнал разработки


## [v2.1.0]
Полная переработка статов, новая вкладка сборки (Build) и внедрение модульного вычисления характеристик скиллов.

- StatRegistry.java, IStat.java, AbstractStat.java: Новая архитектура статов (Strength, Dexterity, Vitality, Intelligence, Magic Power) с динамическим вычислением бонусов на каждый уровень.
- PlayerStatsData.java: Добавлена логика Защиты (Defense), снижающая входящий урон; рефакторинг методов на строковые ID.
- LivingEntityDamageMixin.java: Интегрирован перехват урона и применение множителя Defense (процентное уменьшение).
- StatsScreen.java: Редизайн UI характеристик — прогресс-бары растянуты на новую ширину; Итоговые статы вынесены в отдельную вкладку Tab.BUILD.
- RpgLocale.java: Добавлены ключи для новых статов, вкладки build.
- IAbility.java, AbstractAbility.java: Методы getPower, getCooldown, и getUpgradeDescription теперь каскадно принимают PlayerStatsData для точного скейлинга от статов игрока. Вычищены nullpointer'ы.
- RockThrowAbility.java: Исправлено падение игры из-за null PlayerStatsData при расчете силы булыжника (FallingBlockEntity).


## [v1.2.0-beta]
Редизайн UI и модульность HUD

- RpgHudRenderer.java: панель ресурсов → MMO-док, полноэкранный эффект level-up
- StatsScreen.java: боковая навигация, визуальные блоки статов, радиальное дерево магии
- ElementSelectionScreen.java: карусель из карт Таро с анимацией при наведении
- SettingsScreen.java: стекломорфизм, градиенты, обновлённый скроллбар
- IAbility.java: создан единый интерфейс для всех способностей
- Ability.java, MagicAbility.java: реализуют `IAbility`, добавлен `usesStamina()`
- AbilityCooldownManager.java: полиморфный поиск через `IAbility`
- RpgHudRenderer.java: рендеринг через список `IAbility`, анимация кулдауна для всех скиллов


## [v1.3.0-beta]
ООП-рефакторинг системы способностей

- AbstractAbility.java: новый базовый класс с generic Builder
- Ability.java: упрощён (114→18 строк), наследует `AbstractAbility`
- MagicAbility.java: упрощён (149→64 строки), наследует `AbstractAbility`
- AbilityRegistry.java: объединён с `MagicSkillRegistry`, единый реестр
- MagicSkillRegistry.java: удалён
- StatsNetworking.java: `USE_ABILITY` + `USE_MAGIC_SKILL` → один пакет (~25% меньше кода)
- PlayerStatsData.java: единая `skillLevels`, миграция NBT
- RpgClient.java: единый цикл по `AbilityRegistry.getAll()`
- StatsScreen.java, SettingsScreen.java, RpgHudRenderer.java: единый API


## [v1.4.0-beta]
Редизайн UI + per-player настройки

- PlayerStatsData.java: поля language, openMenuKey, keybinds + NBT сериализация
- StatsNetworking.java: пакет UPDATE_SETTINGS (C→S) для сохранения настроек
- RpgLocale.java: язык из профиля игрока, fallback на RpgConfig
- RenderUtils.java: drawGlassPanel, drawProgressBar, drawCustomButton, drawUpgradeButton, lerp
- StatsScreen.java: полный редизайн — кастомный рендеринг, lerp-фон, анимированные рамки, прогресс-бары
- SettingsScreen.java: полный редизайн — кастомные кнопки, per-player язык/бинды через сетевые пакеты


## [v1.4.1-beta]
Редизайн кнопок Settings UI + автоматизация скиллов

- SettingsScreen.java: убраны все ButtonWidget, замена на кастомный рендеринг (drawBindButton, drawCustomButton), пульсация при ожидании бинда, hover-строки, иконки категорий, звук клика
- RenderUtils.java: добавлены drawSettingsRow, drawBindButton
- CLAUDE.md, GEMINI.md: расширены триггер-фразы, добавлены Auto-trigger Rules (changelog-developer, ui-max-minecraft, brainstorm)
- StatsScreen.java: добавлена тень сайдбара (drop shadow) для единообразия с контентной панелью


## [v2.0.3-beta]
Добавлен счетчик комбо-урона (Damage Combo HUD)

- RpgHudRenderer.java: Новый элемент интерфейса, суммирующий урон за последние 5 секунд. Отображает накопившийся урон и стилизованную шкалу времени.
- StatsNetworking.java: Пакет `ADD_COMBO_DAMAGE` для передачи комбо на клиент.
- LivingEntityDamageMixin.java: Передача урона атакующему игроку для обновления счетчика комбо.
- DamageTextManager.java: Цифры урона теперь 100% точные, белого цвета с четким черным контуром.
Комплексное улучшение UI (Адаптивность, фиксы стилей)

- ElementSelectionScreen.java: заменены невидимые ButtonWidget на mouseClicked, карты рендерятся через drawGlassPanel с hover-подсказками.
- StatsScreen.java: адаптивный сайдбар (% от панели), добавлены разделители категорий, звук кнопок уровня. Кнопка Reset требует подтверждения.
- RpgHudRenderer.java: заменены захардкоженные цвета (панелей и рамок) на стилизованные под текущий MagicElement.
- RpgLocale.java: добавлены ключи element.click_hint и menu.reset.confirm.


## [v1.5.0-beta]
Модульное Дерево Навыков и Стандартизация HUD

- IAbility.java, AbstractAbility.java: добавлен метод getThemeColor() и поддержка themeColor в Builder для ООП-стандартизации цветов.
- MagicAbility.java, DashAbility.java, HealAbility.java: привязаны конкретные цвета для каждого типа (стихия, стамина-оранж, хил-зеленый).
- RpgHudRenderer.java: заменены костыли с if (usesStamina) на использование ability.getThemeColor(), что делает цвета элементов в доке и кулдаунах полностью модульными.
- StatsScreen.java: переработана вкладка магии (сплит-скрин). Дерево навыков сдвинуто влево, при клике на ноду (выделяется белой рамкой) справа открывается панель деталей навыка (lore, стоимость ресурса, кулдаун). Кнопка Upgrade перенесена внутрь панели деталей.
- RpgLocale.java: добавлены локализованные описания (lore) для всех магических скиллов и метод getSkillDesc().


## [v1.5.1-beta]
Глубокий ООП-Рефакторинг Характеристик и Магии

[02.26.2026] v1.5.1-beta - Dynamic Skill Stats & UI Centering
[FEATURE] Навыки:
- Отменена автоматическая выдача базового навыка при выборе стихии. (Теперь игрок должен сам вкачать 1й уровень).
- Обновлен API `IAbility` и `AbstractAbility`: добавлены динамические характеристики `getPower(level)`, `getCooldownSeconds(level)`, `getCooldownTicks(level)`.
- Добавлен метод `getUpgradeDescription(currentLevel)`, возвращающий удобочитаемое описание следующего уровня прокачки навыка.
- Внедрен скейлинг характеристик (Урон, Дальность, Кулдаун, Эффекты) для `DashAbility`, `HealAbility`, `FireballAbility`, `WaterBoltAbility`, `RockThrowAbility`, `GustAbility`, `ShockAbility`.

[UI/UX] StatsScreen & RpgHudRenderer:
- `StatsScreen`: Панель информации о навыках справа теперь центрируется по вертикали с одинаковыми отступами сверху и снизу.
- `StatsScreen`: Добавлен расчет динамической высоты панели на основе кол-ва выводимого текста.
- `StatsScreen`: Добавлен вывод текущих характеристик способности (Расход, Кулдаун) в зависимости от уровня.
- `StatsScreen`: Добавлен вывод "Апгрейд: [Текст]" с информацией о том, что даст следующий уровень навыка.
- `RpgHudRenderer` & `AbilityCooldownManager`: Добавлена передача уровня скилла для корректного расчета прогресса кулдауна.

- MagicElement.java: удалены хардкод-методы getManaColor(), getStaminaColor() и getStatColor(StatType), использовавшие switch. Теперь manaColor и staminaColor — неизменяемые (final) поля, получаемые через конструктор.
- StatType.java: добавлена полная инкапсуляция логики. Внедрены поля baseRegen, regenPerLevel. Описание следующего уровня (getNextLevelDescription) теперь генерируется через лямбду (BiFunction), переданную в конструктор, что позволило избавиться от длинных цепочек if (this == ...). Добавлен метод getColor(MagicElement), определяющий цвет стата.
- StatsScreen.java & RpgHudRenderer.java: обновлены вызовы получения цветов под новую архитектуру (через stat.getColor(el) и поля element.staminaColor).


## [v1.5.2-beta]
Фикс хитбоксов для кнопок и полная локализация навыков

- StatsScreen.java: исправлен баг с хитбоксом кнопки Upgrade на вкладке магии, вынесены хардкод строки
- RpgLocale.java: добавлены ключи локализации (upgrade.unlock_ability, upgrade.max_level, skill.locked и др.)
- DashAbility.java, HealAbility.java, GustAbility.java, WaterBoltAbility.java, ShockAbility.java, FireballAbility.java, RockThrowAbility.java: удалены хардкодные русские описания апгрейдов, добавлен вызов RpgLocale.get
- AbstractAbility.java: удалены хардкодные строки (upgrade.default)

## [v1.5.3-beta]
Отображение базового урона/силы для навыков и своп кнопок UI

- StatsScreen.java: поменял местами кнопки Close и Settings, добавлено отображение характеристики Power (урон/сила/лечение) в панель деталей магических навыков и в список физических скиллов
- RpgLocale.java: добавлены ключи skill.power.damage, skill.power.heal, skill.power.force